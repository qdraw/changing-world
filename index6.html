<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/style.css">

</head>
<body>



<script type="text/javascript">


    var data = {};


    window.onload = function() { init() };

    var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1RKekJPcE5OazkWOWatk04a34HUhOO1nRqIhVaOTtJPk/pubhtml';

    function init() {
        Tabletop.init( { key: public_spreadsheet_url,
            callback: showInfo,
            simpleSheet: true } )
    }

    function showInfo(content, tabletop) {
        // window.requestAnimationFrame(draw);

        console.log(content);

        Object.keys(content).forEach(function(key) {

            data[content[key].code] = new Object();
            data[content[key].code]["img"] = new Image();
            data[content[key].code]["img"]["src"] = "images/countries/" + content[key].code + ".svg";
            data[content[key].code]["x"] = content[key]["x1"];
            data[content[key].code]["y"] = content[key]["y1"];
            data[content[key].code]["s"] = content[key]["s1"];

        });



        // Object.keys(data).forEach(function(key) {
        //  data[content[key].code]["x"] = "";
        // });


        // window.requestAnimationFrame(draw);

        requestAnimationFrame(function() {
            draw(data,content);
        });

    }


    var maxScale = 200;
    var s = 100;
    
    function draw(data,content) {
        var ctx = document.getElementById('canvas').getContext('2d');

        ctx.clearRect(0,0,1000,1000);

        // ctx.clearRect(0,0,1000,1000); // clear canvas

        // console.log(content)     

        Object.keys(content).forEach(function(key) {

            if (data[content[key].code]["x"] < content[key]["x2"]) {
                // console.log("x " + content[key].code + " " + data[content[key].code]["x"]);
                data[content[key].code]["x"]++;
            }
            else {
                data[content[key].code]["x"] = content[key]["x2"];
            }

            if (data[content[key].code]["y"] < content[key]["y2"]) {
                // console.log("y " +data[content[key].code]["y"]);
                data[content[key].code]["y"]++;
            }
            else {
                data[content[key].code]["y"] = content[key]["y2"];
                // console.log(data[content[key].code]["y"])
            }
            
            // s
            if (data[content[key].code]["s"] < content[key]["s2"]) {
                // console.log("y " +data[content[key].code]["y"]);
                data[content[key].code]["s"]++;
            }
            else {
                data[content[key].code]["s"] = content[key]["s2"];
                // console.log(data[content[key].code]["y"])
            }           
            ctx.save();


            ctx.drawImage(data[content[key].code]["img"],data[content[key].code]["x"],data[content[key].code]["y"],data[content[key].code]["s"],data[content[key].code]["s"])

        });

        // window.requestAnimationFrame(draw);

        requestAnimationFrame(function() {
            draw(data,content);
        });

    }

</script>

</body>
</html>